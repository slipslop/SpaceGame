(()=>{"use strict";const t=function(){function t(){this.canv=document.getElementById("gameCanvas"),this.ctx=this.canv.getContext("2d")}return t.prototype.getHeight=function(){return this.canv.height},t.prototype.getWidth=function(){return this.canv.width},t.prototype.getCtx=function(){return this.ctx},t.prototype.setBackground=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.getWidth(),this.getHeight())},t.prototype.setStrokeStyle=function(t,i){this.ctx.strokeStyle=t,this.ctx.lineWidth=i},t.prototype.drawBackground=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.getWidth(),this.getHeight())},t}(),i=function(){function t(){this.fps=30,this.friction=.02}return t.prototype.toRadians=function(t){return t/180*Math.PI},t}(),s=function(){function t(t,s,e){this.velocity=100,this.posX=t,this.posY=s,this.angle=e,this.config=new i}return t.prototype.draw=function(t){t.setStrokeStyle("red",1.5);var i=t.getCtx();i.beginPath(),i.moveTo(this.posX,this.posY),i.lineTo(this.posX+15,this.posY),i.stroke(),this.posX+=this.velocity*Math.cos(this.angle)/30,this.posY-=this.velocity*Math.sin(this.angle)/30},t.prototype.checkOutOfBounds=function(t){return this.posX>t.getWidth()||this.posX<0||this.posY>t.getHeight()||this.posY<0||void 0},t}(),e=function(){function t(t){this.shipSize=30,this.shipThrust=5,this.turnSpeed=360,this.bulletFired=!1,this.config=new i,this.posX=t.getWidth()/2,this.posY=t.getHeight()/2,this.radius=this.shipSize/2,this.angle=this.config.toRadians(90),this.rotation=0,this.thrustingUp=!1,this.thrustingDown=!1,this.thrust={x:0,y:0},this.bullets=[],this.bindEvents()}return t.prototype.calculateThrust=function(){this.thrustingUp?this.handleThrustingUp():this.thrustingDown?this.handleThrustingDown():(this.thrust.x*=1-this.config.friction,this.thrust.y*=1-this.config.friction)},t.prototype.handleThrustingUp=function(){this.thrust.x+=this.shipThrust*Math.cos(this.angle)/this.config.fps,this.thrust.y-=this.shipThrust*Math.sin(this.angle)/this.config.fps},t.prototype.handleThrustingDown=function(){this.thrust.x-=this.shipThrust*Math.cos(this.angle)/this.config.fps,this.thrust.y+=this.shipThrust*Math.sin(this.angle)/this.config.fps},t.prototype.rotateLeft=function(){this.rotation=this.config.toRadians(this.turnSpeed)/this.config.fps},t.prototype.rotateRight=function(){this.rotation=this.config.toRadians(-this.turnSpeed)/this.config.fps},t.prototype.getShipNosePosition=function(){return{x:this.posX+this.radius*Math.cos(this.angle),y:this.posY-this.radius*Math.sin(this.angle)}},t.prototype.draw=function(t){var i=this.shipSize/20,s=t.getCtx();t.setStrokeStyle("white",i),s.beginPath(),s.moveTo(this.getShipNosePosition().x,this.getShipNosePosition().y),s.lineTo(this.getRearLeftEquation()[0],this.getRearLeftEquation()[1]),s.lineTo(this.getRearRightEquation()[0],this.getRearRightEquation()[1]),s.closePath(),s.stroke(),this.angle+=this.rotation,this.posX+=this.thrust.x,this.posY+=this.thrust.y,this.checkCollisions(t)},t.prototype.getRearLeftEquation=function(){return[this.posX-this.radius*(Math.cos(this.angle)+Math.sin(this.angle)),this.posY+this.radius*(Math.sin(this.angle)-Math.cos(this.angle))]},t.prototype.getRearRightEquation=function(){return[this.posX-this.radius*(Math.cos(this.angle)-Math.sin(this.angle)),this.posY+this.radius*(Math.sin(this.angle)+Math.cos(this.angle))]},t.prototype.keyDown=function(t){switch(console.log(this.angle),t.code){case"KeyA":this.rotateLeft();break;case"KeyW":this.thrustingUp=!0;break;case"KeyD":this.rotateRight();break;case"KeyS":this.thrustingDown=!0;break;case"Space":this.fireBullet()}},t.prototype.keyUp=function(t){switch(t.code){case"KeyD":case"KeyA":this.rotation=0;break;case"KeyW":this.thrustingUp=!1;break;case"KeyS":this.thrustingDown=!1;break;case"Space":this.bulletFired=!1}},t.prototype.checkCollisions=function(t){this.leftBorder()?this.posX=t.getWidth()-this.radius:this.bottomBorder(t)?this.posY=0+this.radius:this.topBorder()?this.posY=t.getHeight()-this.radius:this.rightBorder(t)&&(this.posX=0+this.radius)},t.prototype.leftBorder=function(){return this.posX<-25+this.radius},t.prototype.rightBorder=function(t){return this.posX>t.getWidth()-this.radius+25},t.prototype.topBorder=function(){return this.posY<12},t.prototype.bottomBorder=function(t){return this.posY>t.getHeight()-this.radius},t.prototype.fireBullet=function(){if(console.log(this.angle),this.bulletFired)return!0;var t=this.getShipNosePosition(),i=new s(t.x,t.y,this.angle);this.bullets.push(i),this.bulletFired=!0},t.prototype.bindEvents=function(){document.addEventListener("keydown",this.keyDown.bind(this)),document.addEventListener("keyup",this.keyUp.bind(this))},t}();var h=new t,o=new i,n=new e(h);h.setBackground("black"),n.draw(h),console.log(h.getHeight()),console.log(o.fps),setInterval((function(){h.drawBackground("black"),n.calculateThrust(),n.draw(h),n.bullets.forEach((function(t){t.draw(h),t.checkOutOfBounds(h)&&n.bullets.shift()}))}),1e3/o.fps)})();